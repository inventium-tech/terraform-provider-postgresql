name: sonar-scan
run-name: "ðŸ’¡ Sonar Scan ( ${{ github.ref_name }} )"

on:
  push:
    branches:
      - $default-branch
      - $protected-branch
  pull_request:
    paths-ignore:
      - 'assets/**'
      - 'docs/**'
  # Trigger analysis when pushing in master or pull requests, and when creating
  # a pull request.
#  workflow_run:
#    workflows:
#      - build
#    types:
#      - completed

permissions:
  contents: read

jobs:
  sonarcloud:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ðŸ’»
        uses: actions/checkout@v4.1.7
        with:
          # Disabling shallow clone is recommended for improving relevancy of reporting
          fetch-depth: 0

      - name: Download Artifact ðŸ“¦
        uses: actions/download-artifact@v4.1.8
        with:
          name: test-acc-reports-${{ github.ref_name }}

      - name: SonarCloud Scan ðŸ’¡
        uses: sonarsource/sonarcloud-github-action@v2.3.0 # See the latest version at https://github.com/marketplace/actions/sonarcloud-scan
        env:
          SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
